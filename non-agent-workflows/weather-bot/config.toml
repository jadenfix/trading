# Weather Bot — Default Configuration
# Override with environment variables or .env file.
# KALSHI_API_KEY and KALSHI_SECRET_KEY must be set in .env or environment.
# Optional: GOOGLE_WEATHER_API_KEY (required here because quality.require_both_sources = true).

# Use demo environment (set to false for production)
use_demo = true

# Series ticker prefixes for weather market discovery.
series_prefixes = [
    "KXHIGHNYC",
    "KXHIGHCHI",
    "KXHIGHSEA",
    "KXHIGHATL",
    "KXHIGHDAL",
]

[strategy]
entry_threshold_cents = 15      # Buy YES when ask ≤ this
exit_threshold_cents = 45       # Sell YES when bid ≥ this
edge_threshold_cents = 5        # Min fair-ask spread to enter
safety_margin_cents = 3         # Subtracted from fair value
max_position_cents = 400        # $4 max per market (Kelly-capped)
max_trades_per_run = 0          # 0 = no hard cap (quality filters decide)
max_spread_cents = 10           # Skip markets with wider spreads
min_hours_before_close = 2.0    # Don't trade near close
max_days_to_resolution = 11     # Only track markets resolving in < 11 days

[timing]
scan_interval_secs = 120        # Strategy evaluation interval
forecast_interval_secs = 1800   # Forecast refresh (30 min)
discovery_interval_secs = 1800  # Market discovery refresh
price_stale_secs = 300          # Price data staleness (5 min)
forecast_stale_secs = 3600      # Forecast staleness (1 hour)

[weather_sources]
noaa_weight = 0.5               # Relative weight for NOAA
google_weight = 0.5             # Relative weight for Google Weather

[quality]
mode = "ultra_safe"
strict_source_veto = true
require_both_sources = true
max_source_prob_gap = 0.08
min_source_confidence = 0.65
min_ensemble_confidence = 0.75
min_conservative_net_edge_cents = 8
min_conservative_ev_cents = 4
min_volume_24h = 50
min_open_interest = 25
slippage_buffer_cents = 1
max_spread_cents_ultra = 6

[risk]
max_position_cents = 400        # $4 max per market
max_total_exposure_cents = 5000 # $50 total portfolio max
max_city_exposure_cents = 1500  # $15 per city (correlated markets)
max_daily_loss_cents = 2000     # $20 drawdown circuit-breaker
max_orders_per_minute = 10      # Order throttle
min_balance_cents = 100         # Keep at least $1

# Cities are configured with pre-resolved NWS gridpoint coordinates.
# Modify if targeting additional cities.

[[cities]]
name = "New York City"
lat = 40.7128
lon = -74.006
wfo = "OKX"
grid_x = 33
grid_y = 37
series_prefix = "KXHIGHNYC"

[[cities]]
name = "Chicago"
lat = 41.8781
lon = -87.6298
wfo = "LOT"
grid_x = 76
grid_y = 73
series_prefix = "KXHIGHCHI"

[[cities]]
name = "Seattle"
lat = 47.6062
lon = -122.3321
wfo = "SEW"
grid_x = 124
grid_y = 67
series_prefix = "KXHIGHSEA"

[[cities]]
name = "Atlanta"
lat = 33.749
lon = -84.388
wfo = "FFC"
grid_x = 50
grid_y = 86
series_prefix = "KXHIGHATL"

[[cities]]
name = "Dallas"
lat = 32.7767
lon = -96.797
wfo = "FWD"
grid_x = 80
grid_y = 108
series_prefix = "KXHIGHDAL"
